<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Data model - GetML Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Data model";
        var mkdocs_page_input_path = "user_guide/data_model/data_model.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> GetML Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">getML Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User guide</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Annotating data</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../annotating_data/annotating_data/">Annotating data</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Data model</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Data model</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#tables">Tables</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#the-population-table">The population table</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#peripheral-tables">Peripheral tables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#placeholders">Placeholders</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#joins">Joins</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#data-schemata">Data schemata</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#the-star-schema">The star schema</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#the-snowflake-schema">The snowflake schema</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#time-series">Time series</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#self-joining-a-single-table">Self-joining a single table</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#horizon-and-memory">Horizon and Memory</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#time_stamps-and-on">time_stamps and on</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#lagged-target-and-horizon">Lagged Target and horizon</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#features-based-on-time-stamps">Features based on time stamps</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Deployment</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../deployment/deployment/">Deployment</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Feature engineering</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../feature_engineering/feature_engineering/">Feature engineering</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Getml suite</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../getml_suite/engine/">Engine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../getml_suite/getml_suite/">The getML suite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../getml_suite/monitor/">Monitor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../getml_suite/python_api/">Python api</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Hyperopt</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../hyperopt/hyperopt/">Hyperopt</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Importing data</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/csv_interface/">Csv interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/greenplum_interface/">Greenplum interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/importing_data/">Importing data</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/json_interface/">Json interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/mariadb_interface/">Mariadb interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/mysql_interface/">Mysql interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/odbc_interface/">Odbc interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/pandas_interface/">Pandas interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/postgres_interface/">Postgres interface</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../importing_data/sqlite3_interface/">Sqlite3 interface</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Predicting</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../predicting/predicting/">Predicting</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Preprocessing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../preprocessing/preprocessing/">Preprocessing</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Project management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../project_management/project_management/">Project management</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">GetML Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User guide</li>
          <li class="breadcrumb-item">Data model</li>
      <li class="breadcrumb-item active">Data model</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p><a href="" id="data-model"></a></p>
<h1 id="data-model_1">Data model</h1>
<p>Defining the data model is a crucial step before training one of getML's <a href="getml/data/Pipeline"><code>Pipeline</code></a>s. You typically deal with this step after having <a class="autorefs autorefs-internal" href="../../importing_data/importing_data/#importing-data_1">imported your data</a> and <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#roles">specified the roles</a> of each column.</p>
<p>When working with getML, the raw data usually comes in the form of relational data. That means the information relevant for a prediction is spread over several tables. The data model is the definition of the relationships between all of them.</p>
<p>Most relational machine learning problems can be represented in the form of a star schema, in which case you can use the <a href="getml/data/StarSchema"><code>StarSchema</code></a> abstraction. If your data set is a time series, you can use the <a href="getml/data/TimeSeries"><code>TimeSeries</code></a> abstraction.
<a href="" id="data-model-tables"></a></p>
<h2 id="tables">Tables</h2>
<p>When defining the data model, we distinguish between a population table and one or more peripheral tables. In the context of this tutorial, we will use the term "table" as a catch-all for <a href="getml/data/DataFrame"><code>DataFrame</code></a>s and <a href="getml/data/View"><code>View</code></a>s.
<a href="" id="data-model-population-table"></a></p>
<h3 id="the-population-table">The population table</h3>
<p>The population table is the main table of the analysis. It defines the statistical population of your machine learning problem and contains the <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#target">target</a>variable(s), which we want to predict. Furthermore, the table usually also contains one or more columns with the role <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#join-key">join_key</a>. These are keys used to establish a relationship – also called <a class="autorefs autorefs-internal" href="#joins">joins</a> – with one or more peripheral tables.</p>
<p>The example below contains the population table of a customer churn analysis. The target variable is <code>churn</code> – whether a person stops using the services and products of a company. It also contains the information whether or not a given customer has churned after a certain reference date. The join key <code>customer_id</code> is used to establish relations with a <a class="autorefs autorefs-internal" href="#peripheral-tables">peripheral table</a>. Additionally, the date the customer joined the company is contained in the column <code>date_joined</code>, which we have assigned the role <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#time-stamp">time_stamp</a>.
<a href="" id="data-model-peripheral-tables"></a></p>
<h2 id="peripheral-tables">Peripheral tables</h2>
<p>Peripheral tables contain additional information relevant for the prediction of the target variable in the <a class="autorefs autorefs-internal" href="#the-population-table">population table</a>. Each of them is related to the latter (or another peripheral table, refer to <a class="autorefs autorefs-internal" href="#the-snowflake-schema">the snowflake schema</a>) via a <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#join-key">join_key</a>.</p>
<p>The images below represent two peripheral tables that could be used for our customer churn analysis. One table represents complaints a customer made with a certain agent, and the other represents the transactions the customer made using their account.</p>
<p><img alt="Peripheral tables example" src="/res/peripheral_tables.png" />
<a href="" id="data-model-placeholders"></a></p>
<h2 id="placeholders">Placeholders</h2>
<p>In getML, <a href="getml/data/Placeholder"><code>Placeholder</code></a>s are used to construct the <a href="getml/data/DataModel"><code>DataModel</code></a>. They are abstract representations of <a href="getml/data/DataFrame"><code>DataFrame</code></a>s or <a href="getml/data/View"><code>View</code></a>s and the relationships among each other, but do not contain any data themselves.</p>
<p>The idea behind the placeholder concept is that they allow constructing an abstract data model without any reference to an actual data set. This data model serves as input for the <a href="getml/data/Pipeline"><code>Pipeline</code></a>. Later on, the <a href="getml/feature_learning"><code>feature_learning</code></a> algorithms can be trained and applied on any data set that follows this data model.</p>
<p>More information on how to construct placeholders and build a data model can be found in the API documentation for <a href="getml/data/Placeholder"><code>Placeholder</code></a> and <a href="getml/data/DataModel"><code>DataModel</code></a>.
<a href="" id="data-model-joins"></a></p>
<h2 id="joins">Joins</h2>
<p>Joins are used to establish relationships between placeholders. To join two placeholders, the data frames used to derive them should both have at least one <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#join-key">join_key</a>. The joining itself is done using the <a href="getml/data/Placeholder/join"><code>join()</code></a> method.</p>
<p>All columns corresponding to time stamps have to be given the role <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#time-stamp">join_key</a>, and one of them in both the population and peripheral table is usually passed to the <a href="getml/data/Placeholder/join"><code>join()</code></a> method. This approach ensures that no information from the future is considered during training by including only those rows of the peripheral table in the join operation for which the time stamp of the corresponding row in the population table is either the same or more recent.</p>
<p><a href="" id="data-model-data-schemata"></a></p>
<h2 id="data-schemata">Data schemata</h2>
<p>After creating placeholders for all data frames in an analysis, we are ready to create the actual data schema. A data schema is a certain way of assembling population and peripheral tables.</p>
<h3 id="the-star-schema">The star schema</h3>
<p>The <a href="getml/data/StarSchema"><code>StarSchema</code></a> is the simplest way of establishing relations between the population and the peripheral tables, sufficient for the majority of data science projects.</p>
<p>In the star schema, the population table is surrounded by any number of peripheral tables, all joined via a certain join key. However, no joins between peripheral tables are allowed.</p>
<p>Because this is a very popular schema in many machine learning problems on relational data, getML contains a special class for these sorts of problems: <a href="getml/data/StarSchema"><code>StarSchema</code></a>.</p>
<p>The population table and two peripheral tables introduced in <a class="autorefs autorefs-internal" href="#tables">Tables</a> can be arranged in a star schema like this:</p>
<p><img alt="Star schema example" src="/res/star_scheme.png" />
<a href="" id="data-model-snowflake-schema"></a></p>
<h3 id="the-snowflake-schema">The snowflake schema</h3>
<p>In some cases, the star schema is not enough to represent the complexity of a data set. This is where the snowflake schema comes in: In a snowflake schema, peripheral tables can have peripheral tables of their own.</p>
<p>Assume that in the customer churn analysis shown earlier, there is an additional table containing information about the calls a certain agent made in customer service. It can be joined to the <code>COMPLAINTS</code> table using the key <code>agent_id</code>.</p>
<p><img alt="Snowflake schema example" src="/res/snowflake_schema.png" /></p>
<p>To model snowflake schemata, you need to use the <a href="getml/data/DataModel"><code>DataModel</code></a> and <a href="getml/data/Container"><code>Container</code></a> classes.</p>
<p><a href="" id="data-model-time-series"></a></p>
<h2 id="time-series">Time series</h2>
<p>Time series can be handled by a self-join. In addition, some extra parameters and considerations are required when building features based on time stamps.
<a href="" id="data-model-self-join"></a></p>
<h3 id="self-joining-a-single-table">Self-joining a single table</h3>
<p>If you are dealing with a classical (multivariate) time series and all your data is contained in a single table, all the concepts covered so far still apply. You just have to perform a so-called self-join by providing your table as both the population and peripheral table and <a class="autorefs autorefs-internal" href="#joins">join</a> them.</p>
<p>The process works as follows: Whenever a row in the population table - a single measurement - is taken, it will be combined with all the content of the peripheral table - the same time series - for which the time stamps are smaller than the one in the line we picked.</p>
<p>You can also use the <a href="getml/data/TimeSeries"><code>TimeSeries</code></a> abstraction, which abstracts away the self-join. In this case, you do not have to think about self-joins too much.</p>
<h3 id="horizon-and-memory">Horizon and Memory</h3>
<p>Crucial concepts of time series analysis are horizon and memory. In the context of getML's time series analysis, horizon is defined as a point forecast. That means the prediction of the target variable at the point as far in the future as defined by the horizon.   </p>
<p>Memory, on the other hand is the time duration into the past, that is considered when making a prediction. The memory is used to define the time window of data entering the model between the past and <em>now</em>. The horizon defines the point in the future that the predictions is being made for.   </p>
<h3 id="time_stamps-and-on"><code>time_stamps</code> and <code>on</code></h3>
<p>Two parameters in the time series signature determine how the self join is carried out. The <code>time_stamps</code> parameter defines what column is the underlying time dimension to which memory and horizon are applied to. The chosen column must also be of role <a class="autorefs autorefs-internal" href="../../annotating_data/annotating_data/#time-stamp">time_stamp</a>.  </p>
<p><code>on</code> simply provides an extra handle to control, what subset of the data is part of any given time series. For example if you have a time series of sales data, you might want to only consider the sales data of a certain product category. In this case you would specify the <code>on</code> parameter to be the column containing the product category.</p>
<div class="admonition note">
<p class="admonition-title">Tip</p>
<p>If you assign a column to the <code>on</code> parameter, then this column will not enter the model as a predictor. If you have reason to believe that this column is relevant to the model (i.e. the actual product category), duplicate that column in advance and assign the duplicate to the <code>on</code> parameter. (see class method <a href="getml.data.DataFrame.add"><code>add()</code></a>)</p>
</div>
<h3 id="lagged-target-and-horizon">Lagged Target and horizon</h3>
<p>Another useful parameter in time series analysis is <code>lagged_target</code>. This boolean controls whether the target variable is used as a predictor. Including the target variable as a predictor can be useful in time series analysis, when at time of prediction, the target variable up until and including <em>now</em> is known. In turn, this means lagged target variables are only permissible if the target variable is predicted for some when in the future. That is, the horizon must be assigned a positive value.</p>
<h3 id="features-based-on-time-stamps">Features based on time stamps</h3>
<p>The getML engine is able to automatically generate features based on aggregations over time windows. Both the length of the time window and the aggregation itself will be determined by the feature learning algorithm. The only requirement is to provide the temporal resolution your time series is sampled with in the <code>delta_t</code> parameter in any feature learning algorithm.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../annotating_data/annotating_data/" class="btn btn-neutral float-left" title="Annotating data"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../deployment/deployment/" class="btn btn-neutral float-right" title="Deployment">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../annotating_data/annotating_data/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../deployment/deployment/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../javascripts/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
